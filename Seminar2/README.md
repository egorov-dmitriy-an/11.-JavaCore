Переписал программу.
До изменения алгоритма проверки, а также создание интелекта не хватило времени дойти. 
Попробую уже после сдачи сделать.